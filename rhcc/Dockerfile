FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHJvY2tldGNoYXQtcmgtYXBiCmRlc2NyaXB0aW9uOiBUaGlzIEFQ\
QiBkZXBsb3lzIFJvY2tldENoYXQgYmFja2VkIGJ5IE1vbmdvREIKYmluZGFibGU6IEZhbHNlCmFz\
eW5jOiBvcHRpb25hbAptZXRhZGF0YTogCiAgZG9jdW1lbnRhdGlvblVybDogaHR0cHM6Ly9yb2Nr\
ZXQuY2hhdAogIGltYWdlVXJsOiBodHRwczovL2dpdGh1Yi5jb20vUm9ja2V0Q2hhdC9Sb2NrZXQu\
Q2hhdC5BcnR3b3JrL2Jsb2IvbWFzdGVyL0xvZ29zL3JvY2tldGNhdC5wbmc/cmF3PXRydWUKICBk\
ZXBlbmRlbmNpZXM6IFsncmVnaXN0cnkuY29ubmVjdC5yZWRoYXQuY29tL3JvY2tldGNoYXQvcm9j\
a2V0Y2hhdDpsYXRlc3QnLCAncmVnaXN0cnkuYWNjZXNzLnJlZGhhdC5jb20vcmhzY2wvbW9uZ29k\
Yi0zMi1yaGVsNyddCiAgZGlzcGxheU5hbWU6IFJvY2tldENoYXQgUkggKEFQQikKICBsb25nRGVz\
Y3JpcHRpb246IEFuIEFQQiB0aGF0IGRlcGxveXMgUm9ja2V0Q2hhdCB0byBPcGVuU2hpZnQgYmFj\
a2VkIGJ5IE1vbmdvREIKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKcGxh\
bnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIGRlcGxveXMg\
YSBzaW5nbGUgUm9ja2V0Q2hhdCBhcHBsaWNhdGlvbiBiYWNrZWQgYnkgTW9uZ29EQgogICAgZnJl\
ZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZhdWx0CiAgICAgIGxv\
bmdEZXNjcmlwdGlvbjogVGhpcyBwbGFuIHByb3ZpZGVzIGEgUm9ja2V0Q2hhdCBhcHBsaWNhdGlv\
biBiYWNrZWQgYnkgTW9uZ29EQgogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczogCiAg\
ICAgIC0gbmFtZTogbW9uZ29kYl91c2VyCiAgICAgICAgZGVmYXVsdDogcm9ja2V0Y2hhdAogICAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBNb25nb0RCIFVzZXJuYW1lCiAgICAgICAg\
cmVxdWlyZWQ6IFRydWUKICAgICAgLSBuYW1lOiBtb25nb2RiX3Bhc3MKICAgICAgICBkZWZhdWx0\
OiBjaGFuZ2VtZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBNb25nb0RCIFBh\
c3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgLSBuYW1lOiBtb25nb2RiX25hbWUK\
ICAgICAgICBkZWZhdWx0OiByb2NrZXRjaGF0CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAg\
dGl0bGU6IE1vbmdvREIgRGF0YWJhc2UgTmFtZQogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAg\
IC0gbmFtZTogbW9uZ29kYl9hZG1pbl9wYXNzCiAgICAgICAgZGVmYXVsdDogY2hhbmdlbWUKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTW9uZ29EQiBBZG1pbiBQYXNzd29yZAog\
ICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgIC0gbmFtZTogbW9uZ29kYl92ZXJzaW9uCiAgICAg\
ICAgZGVmYXVsdDogIjMuMiIKICAgICAgICBlbnVtOiBbJzMuMicsICcyLjYnXQogICAgICAgIHR5\
cGU6IGVudW0KICAgICAgICB0aXRsZTogTW9uZ29EQiBWZXJzaW9uCiAgICAgICAgcmVxdWlyZWQ6\
IFRydWUKICAgICAgLSBuYW1lOiByb2NrZXRjaGF0X3ZlcnNpb24KICAgICAgICBkZWZhdWx0OiBs\
YXRlc3QKICAgICAgICBlbnVtOiBbJ2xhdGVzdCcsICcwLjU2LjAnXQogICAgICAgIHR5cGU6IGVu\
dW0KICAgICAgICB0aXRsZTogUm9ja2V0Q2hhdCBWZXJzaW9uCiAgICAgICAgcmVxdWlyZWQ6IFRy\
dWUK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
